<!DOCTYPE html>
<html lang="th">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>‡∏£‡∏∞‡∏ö‡∏ö‡∏à‡∏≠‡∏á‡πÇ‡∏ï‡πä‡∏∞‡πÇ‡∏£‡∏á‡∏≠‡∏≤‡∏´‡∏≤‡∏£</title>

<style>
body {
    font-family: 'Kanit', sans-serif;
    background: linear-gradient(135deg, #74ebd5, #ACB6E5);
    padding: 20px;
    text-align: center;
}

.container {
    max-width: 650px;
    margin: auto;
    background: white;
    padding: 25px;
    border-radius: 20px;
    box-shadow: 0 10px 25px rgba(0,0,0,0.15);
}

h2 { margin-bottom: 10px; }

input {
    padding: 12px;
    width: 80%;
    font-size: 16px;
    border-radius: 8px;
    border: 1px solid #ccc;
    text-align: center;
}

.grid-container {
    display: grid;
    grid-template-columns: repeat(3, 1fr);
    gap: 15px;
    margin-top: 25px;
}

.table-card {
    padding: 20px;
    border-radius: 12px;
    cursor: pointer;
    transition: 0.3s;
    font-weight: bold;
    white-space: pre-line;
}

.available {
    background-color: #e8f8f5;
    border: 2px solid #2ecc71;
    color: #27ae60;
}

.available:hover {
    transform: scale(1.05);
}

.booked {
    background-color: #fdecea;
    border: 2px solid #e74c3c;
    color: #c0392b;
    cursor: not-allowed;
}

.selected {
    border: 3px solid #3498db !important;
    background-color: #ebf5fb;
}

button {
    margin-top: 15px;
    padding: 10px 25px;
    border: none;
    border-radius: 8px;
    font-size: 15px;
    cursor: pointer;
    color: white;
}

.confirm-btn { background: #3498db; }
.cancel-btn { background: #f39c12; }
.reset-btn { background: #7f8c8d; }

button:hover { opacity: 0.9; }

.status {
    margin-top: 15px;
    font-weight: bold;
    min-height: 25px;
}

.success { color: #27ae60; }
.error { color: #e74c3c; }
</style>
</head>

<body>

<div class="container">
    <h2>üç¥ ‡∏£‡∏∞‡∏ö‡∏ö‡∏à‡∏≠‡∏á‡πÇ‡∏ï‡πä‡∏∞‡πÇ‡∏£‡∏á‡∏≠‡∏≤‡∏´‡∏≤‡∏£</h2>
    <p>‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡∏Å‡∏£‡∏≠‡∏Å‡∏£‡∏´‡∏±‡∏™‡∏ô‡∏±‡∏Å‡πÄ‡∏£‡∏µ‡∏¢‡∏ô (‡∏ï‡∏±‡∏ß‡πÄ‡∏•‡∏Ç 5 ‡∏´‡∏•‡∏±‡∏Å)</p>

    <input type="text" id="studentId" maxlength="5" inputmode="numeric" placeholder="‡πÄ‡∏ä‡πà‡∏ô 12345">

    <div class="grid-container" id="tableGrid"></div>

    <div class="status" id="statusMessage"></div>

    <button class="confirm-btn" onclick="confirmBooking()">‡∏¢‡∏∑‡∏ô‡∏¢‡∏±‡∏ô‡∏Å‡∏≤‡∏£‡∏à‡∏≠‡∏á</button>
    <button class="cancel-btn" onclick="cancelBooking()">‡∏¢‡∏Å‡πÄ‡∏•‡∏¥‡∏Å‡∏Å‡∏≤‡∏£‡∏à‡∏≠‡∏á‡∏Ç‡∏≠‡∏á‡∏â‡∏±‡∏ô</button>
    <button class="reset-btn" onclick="resetSystem()">‡∏•‡πâ‡∏≤‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î (Admin)</button>
</div>

<script>
const totalTables = 9;
let selectedTable = null;

let tableStatus = JSON.parse(localStorage.getItem('tableBooking')) 
    || Array(totalTables).fill(null);

function renderTables() {
    const grid = document.getElementById('tableGrid');
    grid.innerHTML = '';

    tableStatus.forEach((student, index) => {
        const div = document.createElement('div');
        div.className = 'table-card';

        if (student) {
            div.classList.add('booked');
            const masked = "xxxx" + student.slice(-2);
            div.innerText = `‡πÇ‡∏ï‡πä‡∏∞‡∏ó‡∏µ‡πà ${index + 1}\n‚ùå ‡∏à‡∏≠‡∏á‡πÇ‡∏î‡∏¢: ${masked}`;
        } else {
            div.classList.add('available');
            div.innerText = `‡πÇ‡∏ï‡πä‡∏∞‡∏ó‡∏µ‡πà ${index + 1}\n‚úÖ ‡∏ß‡πà‡∏≤‡∏á`;
            div.onclick = () => selectTable(index);
        }

        if (selectedTable === index) {
            div.classList.add('selected');
        }

        grid.appendChild(div);
    });
}

function selectTable(index) {
    selectedTable = index;
    renderTables();
    setStatus(`‡∏Ñ‡∏∏‡∏ì‡∏Å‡∏≥‡∏•‡∏±‡∏á‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡πÇ‡∏ï‡πä‡∏∞‡∏ó‡∏µ‡πà ${index + 1}`, "success");
}

function confirmBooking() {
    const studentId = document.getElementById('studentId').value.trim();

    if (!/^\d{5}$/.test(studentId)) {
        setStatus("‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡∏Å‡∏£‡∏≠‡∏Å‡∏£‡∏´‡∏±‡∏™‡∏ô‡∏±‡∏Å‡πÄ‡∏£‡∏µ‡∏¢‡∏ô‡πÄ‡∏õ‡πá‡∏ô‡∏ï‡∏±‡∏ß‡πÄ‡∏•‡∏Ç 5 ‡∏´‡∏•‡∏±‡∏Å", "error");
        return;
    }

    if (selectedTable === null) {
        setStatus("‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡πÇ‡∏ï‡πä‡∏∞‡∏Å‡πà‡∏≠‡∏ô‡∏ó‡∏≥‡∏Å‡∏≤‡∏£‡∏à‡∏≠‡∏á", "error");
        return;
    }

    if (tableStatus.includes(studentId)) {
        setStatus("‡∏£‡∏´‡∏±‡∏™‡∏ô‡∏±‡∏Å‡πÄ‡∏£‡∏µ‡∏¢‡∏ô‡∏ô‡∏µ‡πâ‡∏°‡∏µ‡∏Å‡∏≤‡∏£‡∏à‡∏≠‡∏á‡πÇ‡∏ï‡πä‡∏∞‡πÑ‡∏õ‡πÅ‡∏•‡πâ‡∏ß", "error");
        return;
    }

    if (tableStatus[selectedTable] !== null) {
        setStatus("‡πÇ‡∏ï‡πä‡∏∞‡∏ô‡∏µ‡πâ‡∏ñ‡∏π‡∏Å‡∏à‡∏≠‡∏á‡πÑ‡∏õ‡πÅ‡∏•‡πâ‡∏ß", "error");
        return;
    }

    tableStatus[selectedTable] = studentId;
    localStorage.setItem('tableBooking', JSON.stringify(tableStatus));
    selectedTable = null;
    renderTables();
    setStatus("üéâ ‡∏Å‡∏≤‡∏£‡∏à‡∏≠‡∏á‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à!", "success");
}

function cancelBooking() {
    const studentId = document.getElementById('studentId').value.trim();

    if (!/^\d{5}$/.test(studentId)) {
        setStatus("‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡∏Å‡∏£‡∏≠‡∏Å‡∏£‡∏´‡∏±‡∏™‡∏ô‡∏±‡∏Å‡πÄ‡∏£‡∏µ‡∏¢‡∏ô‡πÉ‡∏´‡πâ‡∏ñ‡∏π‡∏Å‡∏ï‡πâ‡∏≠‡∏á", "error");
        return;
    }

    const index = tableStatus.indexOf(studentId);

    if (index === -1) {
        setStatus("‡πÑ‡∏°‡πà‡∏û‡∏ö‡∏Å‡∏≤‡∏£‡∏à‡∏≠‡∏á‡∏Ç‡∏≠‡∏á‡∏£‡∏´‡∏±‡∏™‡∏ô‡∏µ‡πâ", "error");
        return;
    }

    tableStatus[index] = null;
    localStorage.setItem('tableBooking', JSON.stringify(tableStatus));
    renderTables();
    setStatus("‡∏¢‡∏Å‡πÄ‡∏•‡∏¥‡∏Å‡∏Å‡∏≤‡∏£‡∏à‡∏≠‡∏á‡πÄ‡∏£‡∏µ‡∏¢‡∏ö‡∏£‡πâ‡∏≠‡∏¢‡πÅ‡∏•‡πâ‡∏ß", "success");
}

function resetSystem() {
    if (confirm("‡∏ï‡πâ‡∏≠‡∏á‡∏Å‡∏≤‡∏£‡∏•‡πâ‡∏≤‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î‡∏´‡∏£‡∏∑‡∏≠‡πÑ‡∏°‡πà?")) {
        localStorage.removeItem('tableBooking');
        tableStatus = Array(totalTables).fill(null);
        selectedTable = null;
        renderTables();
        setStatus("‡∏•‡πâ‡∏≤‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î‡πÅ‡∏•‡πâ‡∏ß", "success");
    }
}

function setStatus(message, type) {
    const status = document.getElementById('statusMessage');
    status.innerText = message;
    status.className = `status ${type}`;
}

renderTables();
</script>

</body>
</html>
